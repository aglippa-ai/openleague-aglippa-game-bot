require("dotenv").config();

const Telegrambot = require('node-telegram-bot-api');

const bot = new Telegrambot(process.env.BOT_TOKEN, { polling: true });

const options = {
    caption: "Welcome! @@NAME@@!\n"
        + "Aglippa, the ultimate AI Meme Community!\n"
        + "Discover, create, and share hilarious memes generated by advanced AI technology.\n"
        + "Be a part of the next big thing in meme culture.",
    reply_markup: JSON.stringify({
        inline_keyboard: [
            [{ text: 'ðŸŽ® Play Aglippa!', web_app: { url: process.env.WEB_APP_URL } }],
            [{ text: 'ðŸ“œ Aglippa Narrative', url: 'https://www.aglippa.xyz' }],
            [{ text: 'ðŸ† Meme Contest', url: 'https://forms.gle/cPdQA6pbCoCpmmG18' }],
            [{ text: 'ðŸ’¬ Join Chat!', url: 't.me/aglippa_chat' }]
        ]
    })
};

bot.onText(/\/start/, (msg) => {
    const _chatId = msg.chat.id;
    //console.log('msg:', msg);
    options.caption = options.caption.replace('@@NAME@@', msg.chat.first_name);
    bot.sendAnimation(_chatId,
        process.env.BOT_ANIMATION,
        options
    );
    //bot.sendPhoto();
    //bot.sendMessage(chatId, "", options);
});

